{% extends "base.html" %}

{% block title %}–°–æ–∑–¥–∞—Ç—å –∏–≥—Ä—É{% endblock %}

{% block content %}
<div class="content-container">
    <div class="content-header">
        <h1>üéÖ –°–æ–∑–¥–∞—Ç—å –ù–æ–≤—É—é –ò–≥—Ä—É</h1>
        <p>–û—Ä–≥–∞–Ω–∏–∑—É–π –≤–æ–ª—à–µ–±—Å—Ç–≤–æ –¥–ª—è —Å–≤–æ–∏—Ö –¥—Ä—É–∑–µ–π!</p>
    </div>
    <form method="POST" action="/create-game" class="content-sections" id="gameForm">
        <div class="content-section">
            <h2>üìù –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>

            <div class="form-group">
                <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã *</label>
                <input type="text" id="title" name="title"
                       placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: '–ù–æ–≤–æ–≥–æ–¥–Ω–µ–µ —á—É–¥–æ –≤ –æ—Ñ–∏—Å–µ' –∏–ª–∏ '–°–µ–º–µ–π–Ω—ã–π –¢–∞–π–Ω—ã–π –°–∞–Ω—Ç–∞'"
                       required minlength="2" maxlength="200">
                <div class="form-hint">–ú–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞</div>
            </div>

            <div class="form-group">
                <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ –∏–≥—Ä—ã</label>
                <textarea id="description" name="description"
                         placeholder="–†–∞—Å—Å–∫–∞–∂–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –æ –ø—Ä–∞–≤–∏–ª–∞—Ö, –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ –∏–ª–∏ –æ—Å–æ–±—ã—Ö –ø–æ–∂–µ–ª–∞–Ω–∏—è—Ö... üéÑ"
                         rows="4" maxlength="1000"></textarea>
                <div class="char-counter"><span id="descChars">0</span>/1000</div>
            </div>
        </div>

        <div class="content-section">
            <h2>üìÖ –î–∞—Ç–∞ –∏ –±—é–¥–∂–µ—Ç</h2>

            <div class="form-row">
                <div class="form-group">
                    <label for="event_date">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –∂–µ—Ä–µ–±—å–µ–≤–∫–∏ *</label>
                    <input type="datetime-local" id="event_date" name="event_date">
                    <div class="form-hint">–ö–æ–≥–¥–∞ –Ω–∞—á–Ω–µ—Ç—Å—è –æ—Ç–±–æ—Ä –ø–∞—Ä –°–∞–Ω—Ç–∞ - –ø–æ–ª—É—á–∞—Ç–µ–ª—å</div>
                </div>

                <div class="form-group">
                    <label for="budget">–ë—é–¥–∂–µ—Ç –Ω–∞ –ø–æ–¥–∞—Ä–æ–∫ (—Ä—É–±)</label>
                    <input type="number" id="budget" name="budget"
                           placeholder="500" min="0" step="50">
                    <div class="form-hint">–û—Å—Ç–∞–≤—å –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π</div>
                </div>
            </div>
        </div>

        <div class="content-section">
            <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã</h2>

            <div class="toggle-group">
                <label class="toggle-label">
                    <input type="checkbox" id="is_private" name="is_private" value="true"
                        data-public-text="–£—á–∞—Å—Ç–Ω–∏–∫–∏ —Å–º–æ–≥—É—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è —Å—Ä–∞–∑—É –ø–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ–º—É –∫–ª—é—á—É"
                        data-private-text="–£—á–∞—Å—Ç–Ω–∏–∫–∏ —Å–º–æ–≥—É—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –∑–∞—è–≤–∫–∏">
                    <span class="toggle-slider"></span>
                    <span class="toggle-text">–ü—Ä–∏–≤–∞—Ç–Ω–∞—è –∏–≥—Ä–∞</span>
                </label>
                <div class="form-hint" id="privacy-hint">
                    –£—á–∞—Å—Ç–Ω–∏–∫–∏ —Å–º–æ–≥—É—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è —Å—Ä–∞–∑—É –ø–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ–º—É –∫–ª—é—á—É
                </div>
            </div>

            <div class="form-group">
                <label for="status">–°—Ç–∞—Ç—É—Å –∏–≥—Ä—ã</label>
                <select id="status" name="status" class="form-select">
                    <option value="active" selected>–ê–∫—Ç–∏–≤–Ω–∞</option>
                    <option value="draft">–ß–µ—Ä–Ω–æ–≤–∏–∫</option>
                    <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–∞</option>
                </select>
                <div class="form-hint">–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∑–∂–µ</div>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary btn-large">
                üéÑ –°–æ–∑–¥–∞—Ç—å –í–æ–ª—à–µ–±—Å—Ç–≤–æ!
            </button>
        </div>
    </form>
</div>

{% if secret_key %}
<div id="successModal" class="modal" style="display: flex;">
    <div class="modal-content success-content">
        <div class="success-header">
            <span class="success-emoji">üéâ</span>
            <h3>–ò–≥—Ä–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!</h3>
        </div>

        <div class="success-info">
            <p>–¢–≤–æ—è –∏–≥—Ä–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º! –í–æ—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –¥—Ä—É–∑–µ–π:</p>

            <div class="secret-key-display">
                <span class="key-label">–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á:</span>
                <span class="key-value" id="generatedKey">{{ secret_key }}</span>
                <button class="btn-copy" onclick="copySecretKey()">üìã</button>
            </div>

            <div class="success-actions">
                <button onclick="redirectToGames()" class="btn btn-primary">
                    –ü–µ—Ä–µ–π—Ç–∏ –∫ –º–æ–∏–º –∏–≥—Ä–∞–º
                </button>
            </div>

            <div class="success-hint">
                üí° –ù–µ –∑–∞–±—É–¥—å –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –∫–ª—é—á–æ–º —Å –¥—Ä—É–∑—å—è–º–∏, —á—Ç–æ–±—ã –æ–Ω–∏ –º–æ–≥–ª–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è!
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const privacyCheckbox = document.getElementById('is_private');
    const privacyHint = document.getElementById('privacy-hint');

    privacyCheckbox.addEventListener('change', function() {
        if (this.checked) {
            privacyHint.textContent = this.dataset.privateText;
        } else {
            privacyHint.textContent = this.dataset.publicText;
        }
    });
});

document.getElementById('description').addEventListener('input', function() {
    document.getElementById('descChars').textContent = this.value.length;
});

const minDate = new Date();
minDate.setHours(minDate.getHours() + 10);
document.getElementById('event_date').min = minDate.toISOString().slice(0, 16);

function copySecretKey() {
    const keyElement = document.getElementById('generatedKey');
    const keyText = keyElement.textContent;

    navigator.clipboard.writeText(keyText).then(() => {
        const btn = document.querySelector('.btn-copy');
        btn.textContent = '‚úÖ';
        setTimeout(() => {
            btn.textContent = 'üìã';
        }, 2000);
    });
}

function redirectToGames() {
    window.location.href = '/games';
}

window.onclick = function(event) {
    const modal = document.getElementById('successModal');
    if (event.target === modal) {
        modal.style.display = 'none';
    }
}
</script>
{% endblock %}