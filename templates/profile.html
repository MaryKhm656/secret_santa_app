{% extends "base.html" %}

{% block title %}–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å{% endblock %}

{% block content %}
<div class="profile-container">
    <div class="profile-header">
        <div class="avatar-section">
            <div class="avatar-large">
                {{ current_user.username[0]|upper if current_user.username else current_user.email[0]|upper }}
            </div>
            <h1>–ü—Ä–∏–≤–µ—Ç, {{ current_user.username or current_user.email }}! üéÖ</h1>
            <p class="profile-subtitle">–ì–æ—Ç–æ–≤—å –º–µ—à–æ–∫ - –ø–æ—Ä–∞ –¥–∞—Ä–∏—Ç—å –ø–æ–¥–∞—Ä–∫–∏!</p>
        </div>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">2</div>
            <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä</div>
            <div class="stat-emoji">üéÆ</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">2</div>
            <div class="stat-label">–ü–æ–¥–∞—Ä–∫–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</div>
            <div class="stat-emoji">üéÅ</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">2</div>
            <div class="stat-label">–ü–æ–¥–∞—Ä–∫–æ–≤ –ø–æ–ª—É—á–µ–Ω–æ</div>
            <div class="stat-emoji">üì¶</div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã -->
    <div class="profile-sections">
        <!-- –í–∏—à–ª–∏—Å—Ç -->
        <section class="profile-section">
            <h2>üéÑ –ú–æ–π –≤–∏—à–ª–∏—Å—Ç</h2>
            <div class="wishlist-content">
                {% if current_user.wishlist %}
                    <p>{{ current_user.wishlist }}</p>
                {% else %}
                    <p class="empty-state">–†–∞—Å—Å–∫–∞–∂–∏ –°–∞–Ω—Ç–µ –æ —Å–≤–æ–∏—Ö –∂–µ–ª–∞–Ω–∏—è—Ö! üéÅ</p>
                {% endif %}
                <button class="btn btn-secondary" onclick="editWishlist()">
                    {{ '–ò–∑–º–µ–Ω–∏—Ç—å' if current_user.wishlist else '–î–æ–±–∞–≤–∏—Ç—å' }} –≤–∏—à–ª–∏—Å—Ç
                </button>
            </div>
        </section>

        <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
        <section class="profile-section">
            <h2>‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
            <div class="action-buttons">
                <a href="/create-game" class="action-btn">
                    <span class="action-emoji">‚ú®</span>
                    <span>–°–æ–∑–¥–∞—Ç—å –∏–≥—Ä—É</span>
                </a>
                <a href="/games" class="action-btn">
                    <span class="action-emoji">üéÆ</span>
                    <span>–ú–æ–∏ –∏–≥—Ä—ã</span>
                </a>
                <a href="/gifts" class="action-btn">
                    <span class="action-emoji">üéÅ</span>
                    <span>–ú–æ–∏ –ø–æ–¥–∞—Ä–∫–∏</span>
                </a>
                <a href="/chat" class="action-btn">
                    <span class="action-emoji">üí¨</span>
                    <span>–ß–∞—Ç —Å —Å–∞–Ω—Ç–∞–º–∏</span>
                </a>
            </div>
        </section>

        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <section class="profile-section">
            <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            <div class="settings-list">
                <div class="setting-item">
                    <span>üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span>
                    <span class="setting-value">{{ current_user.username or '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' }}</span>
                </div>
                <div class="setting-item">
                    <span>üìß Email</span>
                    <span class="setting-value">{{ current_user.email }}</span>
                </div>
                <div class="setting-item">
                    <span>üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                    <span class="setting-value">–í–∫–ª—é—á–µ–Ω—ã</span>
                </div>
                <div class="setting-actions">
                    <button class="btn btn-outline">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                    <button class="btn btn-outline">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</button>
                </div>
            </div>
        </section>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏—à–ª–∏—Å—Ç–∞ -->
<div id="wishlistModal" class="modal">
    <div class="modal-content">
        <h3>üéÅ –ú–æ–π –≤–∏—à–ª–∏—Å—Ç</h3>
        <form method="POST" action="/update-wishlist">
            <textarea name="wishlist" placeholder="–†–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å –Ω–∞ –ù–æ–≤—ã–π –ì–æ–¥... üéÑ" 
                     rows="5">{{ current_user.wishlist or '' }}</textarea>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function editWishlist() {
    document.getElementById('wishlistModal').style.display = 'flex';
}

function closeModal() {
    document.getElementById('wishlistModal').style.display = 'none';
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ—ë
window.onclick = function(event) {
    const modal = document.getElementById('wishlistModal');
    if (event.target === modal) {
        closeModal();
    }
}
</script>
{% endblock %}