{% extends "base.html" %}

{% block title %}–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å{% endblock %}

{% block content %}
<div class="content-container">
    <div class="content-header">
        <div class="avatar-section">
            <div class="avatar-large">
                {{ current_user.username[0]|upper if current_user.username else current_user.email[0]|upper }}
            </div>
            <h1>–ü—Ä–∏–≤–µ—Ç, {{ current_user.username or current_user.email }}! üéÖ</h1>
            <p class="profile-subtitle">–ì–æ—Ç–æ–≤—å –º–µ—à–æ–∫ - –ø–æ—Ä–∞ –¥–∞—Ä–∏—Ç—å –ø–æ–¥–∞—Ä–∫–∏!</p>
        </div>
    </div>

    <div class="content-sections">
        <section class="content-section">
            <h2>üéÑ –ú–æ–π –≤–∏—à–ª–∏—Å—Ç</h2>
            <div class="wishlist-content">
                {% if current_user.wishlist %}
                    <p>{{ current_user.wishlist }}</p>
                {% else %}
                    <p class="empty-state">–†–∞—Å—Å–∫–∞–∂–∏ –°–∞–Ω—Ç–µ –æ —Å–≤–æ–∏—Ö –∂–µ–ª–∞–Ω–∏—è—Ö! üéÅ</p>
                {% endif %}
                <button class="btn btn-secondary" onclick="editWishlist()">
                    {{ '–ò–∑–º–µ–Ω–∏—Ç—å' if current_user.wishlist else '–î–æ–±–∞–≤–∏—Ç—å' }} –≤–∏—à–ª–∏—Å—Ç
                </button>
            </div>
        </section>

        <section class="content-section">
            <h2>‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
            <div class="action-buttons">
                <a href="/create-game" class="action-btn">
                    <span class="action-emoji">‚ú®</span>
                    <span>–°–æ–∑–¥–∞—Ç—å –∏–≥—Ä—É</span>
                </a>
                <a href="/games" class="action-btn">
                    <span class="action-emoji">üéÆ</span>
                    <span>–ú–æ–∏ –∏–≥—Ä—ã</span>
                </a>
                <a href="/gifts" class="action-btn">
                    <span class="action-emoji">üéÅ</span>
                    <span>–ú–æ–∏ –ø–æ–¥–∞—Ä–∫–∏</span>
                </a>
                <a href="/requests" class="action-btn">
                    <span class="action-emoji">üì®</span>
                    <span>–ó–∞—è–≤–∫–∏</span>
                </a>
            </div>
        </section>
        <section class="content-section">
            <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            <div class="content-list">
                <div class="setting-item">
                    <span>üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span>
                    <span class="setting-value">{{ current_user.username or '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' }}</span>
                </div>
                <div class="setting-item">
                    <span>üìß Email</span>
                    <span class="setting-value">{{ current_user.email }}</span>
                </div>
                <div class="setting-actions">
                    <a href="/edit-profile/{{ current_user.id }}" class="btn btn-outline">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                </div>
                <form action="/delete-user/{{ current_user.id }}" method="POST" style="display: inline;">
                    <button type="submit" class="btn"
                            onclick="return confirm('–£–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å?')">
                        –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                    </button>
                </form>
            </div>
        </section>
    </div>
</div>

<div id="wishlistModal" class="modal">
    <div class="modal-content">
        <h3>üéÅ –ú–æ–π –≤–∏—à–ª–∏—Å—Ç</h3>
        <form method="POST" action="/update-wishlist">
            <textarea name="wishlist_text" placeholder="–†–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ —Ç—ã —Ö–æ—á–µ—à—å –Ω–∞ –ù–æ–≤—ã–π –ì–æ–¥... üéÑ"
                     rows="5">{{ current_user.wishlist or '' }}</textarea>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function editWishlist() {
    document.getElementById('wishlistModal').style.display = 'flex';
}

function closeModal() {
    document.getElementById('wishlistModal').style.display = 'none';
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∫–∏ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –µ—ë
window.onclick = function(event) {
    const modal = document.getElementById('wishlistModal');
    if (event.target === modal) {
        closeModal();
    }
}
</script>
{% endblock %}